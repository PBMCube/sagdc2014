(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var Item = function (game, x, y, item) {
    this.name = item;
    Phaser.Sprite.call(this, game, x, y, item);
    game.add.existing(this);
}

Item.prototype = Object.create(Phaser.Sprite.prototype);
Item.prototype.constructor = Item;

Item.prototype.update = function() {
};

Item.prototype.onUse = function() {
};

Item.prototype.onClick = function() {
    if (Utils.containsObject(this, playerState.inventory)) playerState.currentlyEquipped = this;
    else playerState.inventory.add(this);
};

module.exports = Item;

},{}],2:[function(require,module,exports){
var Item = require('../item');

var SpecificItem = function (game, x, y) {
    Item.call(this, game, x, y, 'specificitem');
};

SpecificItem.prototype = Object.create(Item.prototype);
SpecificItem.prototype.constructor = SpecificItem;

SpecificItem.prototype.onUse = function (arg1, arg2) {
  // ...
};

module.exports = SpecificItem
},{"../item":1}],3:[function(require,module,exports){
var Player = function (game, x, y) {
    Phaser.Sprite.call(this, game, x, y, 'testsprite');
    game.add.existing(this);
}

Player.prototype = Object.create(Phaser.Sprite.prototype);
Player.prototype.constructor = Player;

/**
 * Automatically called by World.update
 */
Player.prototype.update = function() {
};

module.exports = Player;

},{}],4:[function(require,module,exports){
'use strict';

window.game = new Phaser.Game(800, 600, Phaser.AUTO, 'sagdc-game');

window.Utils = require('./utils');

window.Player = require('./entities/player');
window.SpecificItem = require('./entities/items/specificitem');

window.playerState = {
    UUID: '',
    inventory: [], 	     // List of Item
    currentlyEquipped: null, // Item
    currentLevel: 'Game'
}

if (Utils.localStorageSupported()) {
     if (localStorage['playerState'] !== undefined) {
        playerState = Utils.getObject('playerState');
    } else {
        playerState.UUID = Utils.generateUUID();   
        Utils.setObject('playerState', playerState);
    }
} else {
    alert("Local storage not supported - you cannot save!");
}

game.state.add('Boot', require('./states/boot'));
game.state.add('Splash', require('./states/splash'));
game.state.add('Preloader', require('./states/preloader'));
game.state.add('Menu', require('./states/menu'));
game.state.add('Game', require('./states/game'));

game.state.start('Boot');

},{"./entities/items/specificitem":2,"./entities/player":3,"./states/boot":5,"./states/game":6,"./states/menu":7,"./states/preloader":8,"./states/splash":9,"./utils":10}],5:[function(require,module,exports){
var Boot = function () {};

module.exports = Boot;

Boot.prototype = {

  preload: function () {
    this.load.image('preloader', 'assets/preloader.gif');
  },

  create: function () {
    this.game.input.maxPointers = 1;
    // this.game.stage.disableVisibilityChange = true;

    if (this.game.device.desktop) {
      this.game.stage.scale.pageAlignHorizontally = true;
    } else {
      this.game.stage.scaleMode = Phaser.StageScaleMode.SHOW_ALL;
      this.game.stage.scale.minWidth =  480;
      this.game.stage.scale.minHeight = 260;
      this.game.stage.scale.maxWidth = 640;
      this.game.stage.scale.maxHeight = 480;
      this.game.stage.scale.forceLandscape = true;
      this.game.stage.scale.pageAlignHorizontally = true;
      this.game.stage.scale.setScreenSize(true);
    }
    this.game.state.start('Preloader');
  }
};

},{}],6:[function(require,module,exports){
var Game = function () {
  this.testentity = null;
};

module.exports = Game;

Game.prototype = {

  create: function () {
    var x = (this.game.width / 2) - 100;
    var y = (this.game.height / 2) - 50;

    this.testentity = new Player(this.game, x, y);
    this.testentity.anchor.setTo(0.5, 0.5);

    this.input.onDown.add(this.onInputDown, this);
  },

  update: function () {
    var x, y, cx, cy, dx, dy, angle, scale;

    x = this.input.position.x;
    y = this.input.position.y;
    cx = this.world.centerX;
    cy = this.world.centerY;

    angle = Math.atan2(y - cy, x - cx) * (180 / Math.PI);
    this.testentity.angle = angle;

    dx = x - cx;
    dy = y - cy;
    scale = Math.sqrt(dx * dx + dy * dy) / 100;

    this.testentity.scale.x = scale * 0.6;
    this.testentity.scale.y = scale * 0.6;
  },

  onInputDown: function () {
    this.game.state.start('Menu');
  }

};

},{}],7:[function(require,module,exports){
var Menu = function () {
  this.text = null;
};

module.exports = Menu;

Menu.prototype = {

  create: function () {
    var x = this.game.width / 2;
    var y = this.game.height / 2;

    var style = { font: "65px Arial", fill: "#ffffff", align: "center" };

    this.text = this.add.text(x - 300, y - 200, "Press to Start", style);

    this.input.onDown.add(this.onDown, this);
  },

  update: function () {
  },

  onDown: function () {
    this.game.state.start(playerState.currentLevel);
  }
};

},{}],8:[function(require,module,exports){
var Preloader = function (game) {
  this.asset = null;
  this.ready = false;
};

module.exports = Preloader;

Preloader.prototype = {

  preload: function () {
    this.asset = this.add.sprite(320, 240, 'preloader');
    this.asset.anchor.setTo(0.5, 0.5);

    this.load.onLoadComplete.addOnce(this.onLoadComplete, this);
    this.load.setPreloadSprite(this.asset);
    this.load.image('testsprite', 'assets/test.png');
  },

  create: function () {
    this.asset.cropEnabled = false;
  },

  update: function () {
    if (!!this.ready) {
      this.game.state.start('Menu');
    }
  },

  onLoadComplete: function () {
    this.ready = true;
  }
};

},{}],9:[function(require,module,exports){
var Splash = function (game) {
};

module.exports = Splash;

Splash.prototype = {
  create: function () {
  }
};
},{}],10:[function(require,module,exports){
var Utils = {
    containsObject: function(obj, list) {
        var i;
        for (i = 0; i < list.length; i++) {
            if (list[i] === obj) {
                return true;
            }
        }

        return false;
    },

    localStorageSupported: function() {
        try {
            return 'localStorage' in window && window['localStorage'] !== null;
        } catch (e) {
            return false;
        }
    },

    generateUUID: function(){
        var d = Date.now();
        var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
            var r = (d + Math.random()*16)%16 | 0;
            d = Math.floor(d/16);
            return (c=='x' ? r : (r&0x7|0x8)).toString(16);
        });
        return uuid;
    },

    getObject: function(key, value) {
        var value = localStorage.getItem(key);
        return value && JSON.parse(value);
    },

    setObject: function(key, value) {
        localStorage.setItem(key, JSON.stringify(value));
    }
};

module.exports = Utils;
},{}]},{},[4])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXEp1c3RpblxcRG9jdW1lbnRzXFxQcm9qZWN0c1xcc2FnZGMyMDE0XFxub2RlX21vZHVsZXNcXGJyb3dzZXJpZnlcXG5vZGVfbW9kdWxlc1xcYnJvd3Nlci1wYWNrXFxfcHJlbHVkZS5qcyIsIkM6L1VzZXJzL0p1c3Rpbi9Eb2N1bWVudHMvUHJvamVjdHMvc2FnZGMyMDE0L3NyYy9qcy9lbnRpdGllcy9pdGVtLmpzIiwiQzovVXNlcnMvSnVzdGluL0RvY3VtZW50cy9Qcm9qZWN0cy9zYWdkYzIwMTQvc3JjL2pzL2VudGl0aWVzL2l0ZW1zL3NwZWNpZmljaXRlbS5qcyIsIkM6L1VzZXJzL0p1c3Rpbi9Eb2N1bWVudHMvUHJvamVjdHMvc2FnZGMyMDE0L3NyYy9qcy9lbnRpdGllcy9wbGF5ZXIuanMiLCJDOi9Vc2Vycy9KdXN0aW4vRG9jdW1lbnRzL1Byb2plY3RzL3NhZ2RjMjAxNC9zcmMvanMvbWFpbi5qcyIsIkM6L1VzZXJzL0p1c3Rpbi9Eb2N1bWVudHMvUHJvamVjdHMvc2FnZGMyMDE0L3NyYy9qcy9zdGF0ZXMvYm9vdC5qcyIsIkM6L1VzZXJzL0p1c3Rpbi9Eb2N1bWVudHMvUHJvamVjdHMvc2FnZGMyMDE0L3NyYy9qcy9zdGF0ZXMvZ2FtZS5qcyIsIkM6L1VzZXJzL0p1c3Rpbi9Eb2N1bWVudHMvUHJvamVjdHMvc2FnZGMyMDE0L3NyYy9qcy9zdGF0ZXMvbWVudS5qcyIsIkM6L1VzZXJzL0p1c3Rpbi9Eb2N1bWVudHMvUHJvamVjdHMvc2FnZGMyMDE0L3NyYy9qcy9zdGF0ZXMvcHJlbG9hZGVyLmpzIiwiQzovVXNlcnMvSnVzdGluL0RvY3VtZW50cy9Qcm9qZWN0cy9zYWdkYzIwMTQvc3JjL2pzL3N0YXRlcy9zcGxhc2guanMiLCJDOi9Vc2Vycy9KdXN0aW4vRG9jdW1lbnRzL1Byb2plY3RzL3NhZ2RjMjAxNC9zcmMvanMvdXRpbHMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNiQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNmQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3Rocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIil9dmFyIGY9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGYuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sZixmLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsInZhciBJdGVtID0gZnVuY3Rpb24gKGdhbWUsIHgsIHksIGl0ZW0pIHtcclxuICAgIHRoaXMubmFtZSA9IGl0ZW07XHJcbiAgICBQaGFzZXIuU3ByaXRlLmNhbGwodGhpcywgZ2FtZSwgeCwgeSwgaXRlbSk7XHJcbiAgICBnYW1lLmFkZC5leGlzdGluZyh0aGlzKTtcclxufVxyXG5cclxuSXRlbS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5TcHJpdGUucHJvdG90eXBlKTtcclxuSXRlbS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBJdGVtO1xyXG5cclxuSXRlbS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7XHJcbn07XHJcblxyXG5JdGVtLnByb3RvdHlwZS5vblVzZSA9IGZ1bmN0aW9uKCkge1xyXG59O1xyXG5cclxuSXRlbS5wcm90b3R5cGUub25DbGljayA9IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKFV0aWxzLmNvbnRhaW5zT2JqZWN0KHRoaXMsIHBsYXllclN0YXRlLmludmVudG9yeSkpIHBsYXllclN0YXRlLmN1cnJlbnRseUVxdWlwcGVkID0gdGhpcztcclxuICAgIGVsc2UgcGxheWVyU3RhdGUuaW52ZW50b3J5LmFkZCh0aGlzKTtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gSXRlbTtcclxuIiwidmFyIEl0ZW0gPSByZXF1aXJlKCcuLi9pdGVtJyk7XHJcblxyXG52YXIgU3BlY2lmaWNJdGVtID0gZnVuY3Rpb24gKGdhbWUsIHgsIHkpIHtcclxuICAgIEl0ZW0uY2FsbCh0aGlzLCBnYW1lLCB4LCB5LCAnc3BlY2lmaWNpdGVtJyk7XHJcbn07XHJcblxyXG5TcGVjaWZpY0l0ZW0ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShJdGVtLnByb3RvdHlwZSk7XHJcblNwZWNpZmljSXRlbS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBTcGVjaWZpY0l0ZW07XHJcblxyXG5TcGVjaWZpY0l0ZW0ucHJvdG90eXBlLm9uVXNlID0gZnVuY3Rpb24gKGFyZzEsIGFyZzIpIHtcclxuICAvLyAuLi5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gU3BlY2lmaWNJdGVtIiwidmFyIFBsYXllciA9IGZ1bmN0aW9uIChnYW1lLCB4LCB5KSB7XHJcbiAgICBQaGFzZXIuU3ByaXRlLmNhbGwodGhpcywgZ2FtZSwgeCwgeSwgJ3Rlc3RzcHJpdGUnKTtcclxuICAgIGdhbWUuYWRkLmV4aXN0aW5nKHRoaXMpO1xyXG59XHJcblxyXG5QbGF5ZXIucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQaGFzZXIuU3ByaXRlLnByb3RvdHlwZSk7XHJcblBsYXllci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBQbGF5ZXI7XHJcblxyXG4vKipcclxuICogQXV0b21hdGljYWxseSBjYWxsZWQgYnkgV29ybGQudXBkYXRlXHJcbiAqL1xyXG5QbGF5ZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBQbGF5ZXI7XHJcbiIsIid1c2Ugc3RyaWN0JztcclxuXHJcbndpbmRvdy5nYW1lID0gbmV3IFBoYXNlci5HYW1lKDgwMCwgNjAwLCBQaGFzZXIuQVVUTywgJ3NhZ2RjLWdhbWUnKTtcclxuXHJcbndpbmRvdy5VdGlscyA9IHJlcXVpcmUoJy4vdXRpbHMnKTtcclxuXHJcbndpbmRvdy5QbGF5ZXIgPSByZXF1aXJlKCcuL2VudGl0aWVzL3BsYXllcicpO1xyXG53aW5kb3cuU3BlY2lmaWNJdGVtID0gcmVxdWlyZSgnLi9lbnRpdGllcy9pdGVtcy9zcGVjaWZpY2l0ZW0nKTtcclxuXHJcbndpbmRvdy5wbGF5ZXJTdGF0ZSA9IHtcclxuICAgIFVVSUQ6ICcnLFxyXG4gICAgaW52ZW50b3J5OiBbXSwgXHQgICAgIC8vIExpc3Qgb2YgSXRlbVxyXG4gICAgY3VycmVudGx5RXF1aXBwZWQ6IG51bGwsIC8vIEl0ZW1cclxuICAgIGN1cnJlbnRMZXZlbDogJ0dhbWUnXHJcbn1cclxuXHJcbmlmIChVdGlscy5sb2NhbFN0b3JhZ2VTdXBwb3J0ZWQoKSkge1xyXG4gICAgIGlmIChsb2NhbFN0b3JhZ2VbJ3BsYXllclN0YXRlJ10gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHBsYXllclN0YXRlID0gVXRpbHMuZ2V0T2JqZWN0KCdwbGF5ZXJTdGF0ZScpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBwbGF5ZXJTdGF0ZS5VVUlEID0gVXRpbHMuZ2VuZXJhdGVVVUlEKCk7ICAgXHJcbiAgICAgICAgVXRpbHMuc2V0T2JqZWN0KCdwbGF5ZXJTdGF0ZScsIHBsYXllclN0YXRlKTtcclxuICAgIH1cclxufSBlbHNlIHtcclxuICAgIGFsZXJ0KFwiTG9jYWwgc3RvcmFnZSBub3Qgc3VwcG9ydGVkIC0geW91IGNhbm5vdCBzYXZlIVwiKTtcclxufVxyXG5cclxuZ2FtZS5zdGF0ZS5hZGQoJ0Jvb3QnLCByZXF1aXJlKCcuL3N0YXRlcy9ib290JykpO1xyXG5nYW1lLnN0YXRlLmFkZCgnU3BsYXNoJywgcmVxdWlyZSgnLi9zdGF0ZXMvc3BsYXNoJykpO1xyXG5nYW1lLnN0YXRlLmFkZCgnUHJlbG9hZGVyJywgcmVxdWlyZSgnLi9zdGF0ZXMvcHJlbG9hZGVyJykpO1xyXG5nYW1lLnN0YXRlLmFkZCgnTWVudScsIHJlcXVpcmUoJy4vc3RhdGVzL21lbnUnKSk7XHJcbmdhbWUuc3RhdGUuYWRkKCdHYW1lJywgcmVxdWlyZSgnLi9zdGF0ZXMvZ2FtZScpKTtcclxuXHJcbmdhbWUuc3RhdGUuc3RhcnQoJ0Jvb3QnKTtcclxuIiwidmFyIEJvb3QgPSBmdW5jdGlvbiAoKSB7fTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gQm9vdDtcclxuXHJcbkJvb3QucHJvdG90eXBlID0ge1xyXG5cclxuICBwcmVsb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ3ByZWxvYWRlcicsICdhc3NldHMvcHJlbG9hZGVyLmdpZicpO1xyXG4gIH0sXHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5nYW1lLmlucHV0Lm1heFBvaW50ZXJzID0gMTtcclxuICAgIC8vIHRoaXMuZ2FtZS5zdGFnZS5kaXNhYmxlVmlzaWJpbGl0eUNoYW5nZSA9IHRydWU7XHJcblxyXG4gICAgaWYgKHRoaXMuZ2FtZS5kZXZpY2UuZGVza3RvcCkge1xyXG4gICAgICB0aGlzLmdhbWUuc3RhZ2Uuc2NhbGUucGFnZUFsaWduSG9yaXpvbnRhbGx5ID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuZ2FtZS5zdGFnZS5zY2FsZU1vZGUgPSBQaGFzZXIuU3RhZ2VTY2FsZU1vZGUuU0hPV19BTEw7XHJcbiAgICAgIHRoaXMuZ2FtZS5zdGFnZS5zY2FsZS5taW5XaWR0aCA9ICA0ODA7XHJcbiAgICAgIHRoaXMuZ2FtZS5zdGFnZS5zY2FsZS5taW5IZWlnaHQgPSAyNjA7XHJcbiAgICAgIHRoaXMuZ2FtZS5zdGFnZS5zY2FsZS5tYXhXaWR0aCA9IDY0MDtcclxuICAgICAgdGhpcy5nYW1lLnN0YWdlLnNjYWxlLm1heEhlaWdodCA9IDQ4MDtcclxuICAgICAgdGhpcy5nYW1lLnN0YWdlLnNjYWxlLmZvcmNlTGFuZHNjYXBlID0gdHJ1ZTtcclxuICAgICAgdGhpcy5nYW1lLnN0YWdlLnNjYWxlLnBhZ2VBbGlnbkhvcml6b250YWxseSA9IHRydWU7XHJcbiAgICAgIHRoaXMuZ2FtZS5zdGFnZS5zY2FsZS5zZXRTY3JlZW5TaXplKHRydWUpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdQcmVsb2FkZXInKTtcclxuICB9XHJcbn07XHJcbiIsInZhciBHYW1lID0gZnVuY3Rpb24gKCkge1xyXG4gIHRoaXMudGVzdGVudGl0eSA9IG51bGw7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEdhbWU7XHJcblxyXG5HYW1lLnByb3RvdHlwZSA9IHtcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgeCA9ICh0aGlzLmdhbWUud2lkdGggLyAyKSAtIDEwMDtcclxuICAgIHZhciB5ID0gKHRoaXMuZ2FtZS5oZWlnaHQgLyAyKSAtIDUwO1xyXG5cclxuICAgIHRoaXMudGVzdGVudGl0eSA9IG5ldyBQbGF5ZXIodGhpcy5nYW1lLCB4LCB5KTtcclxuICAgIHRoaXMudGVzdGVudGl0eS5hbmNob3Iuc2V0VG8oMC41LCAwLjUpO1xyXG5cclxuICAgIHRoaXMuaW5wdXQub25Eb3duLmFkZCh0aGlzLm9uSW5wdXREb3duLCB0aGlzKTtcclxuICB9LFxyXG5cclxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciB4LCB5LCBjeCwgY3ksIGR4LCBkeSwgYW5nbGUsIHNjYWxlO1xyXG5cclxuICAgIHggPSB0aGlzLmlucHV0LnBvc2l0aW9uLng7XHJcbiAgICB5ID0gdGhpcy5pbnB1dC5wb3NpdGlvbi55O1xyXG4gICAgY3ggPSB0aGlzLndvcmxkLmNlbnRlclg7XHJcbiAgICBjeSA9IHRoaXMud29ybGQuY2VudGVyWTtcclxuXHJcbiAgICBhbmdsZSA9IE1hdGguYXRhbjIoeSAtIGN5LCB4IC0gY3gpICogKDE4MCAvIE1hdGguUEkpO1xyXG4gICAgdGhpcy50ZXN0ZW50aXR5LmFuZ2xlID0gYW5nbGU7XHJcblxyXG4gICAgZHggPSB4IC0gY3g7XHJcbiAgICBkeSA9IHkgLSBjeTtcclxuICAgIHNjYWxlID0gTWF0aC5zcXJ0KGR4ICogZHggKyBkeSAqIGR5KSAvIDEwMDtcclxuXHJcbiAgICB0aGlzLnRlc3RlbnRpdHkuc2NhbGUueCA9IHNjYWxlICogMC42O1xyXG4gICAgdGhpcy50ZXN0ZW50aXR5LnNjYWxlLnkgPSBzY2FsZSAqIDAuNjtcclxuICB9LFxyXG5cclxuICBvbklucHV0RG93bjogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdNZW51Jyk7XHJcbiAgfVxyXG5cclxufTtcclxuIiwidmFyIE1lbnUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdGhpcy50ZXh0ID0gbnVsbDtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gTWVudTtcclxuXHJcbk1lbnUucHJvdG90eXBlID0ge1xyXG5cclxuICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciB4ID0gdGhpcy5nYW1lLndpZHRoIC8gMjtcclxuICAgIHZhciB5ID0gdGhpcy5nYW1lLmhlaWdodCAvIDI7XHJcblxyXG4gICAgdmFyIHN0eWxlID0geyBmb250OiBcIjY1cHggQXJpYWxcIiwgZmlsbDogXCIjZmZmZmZmXCIsIGFsaWduOiBcImNlbnRlclwiIH07XHJcblxyXG4gICAgdGhpcy50ZXh0ID0gdGhpcy5hZGQudGV4dCh4IC0gMzAwLCB5IC0gMjAwLCBcIlByZXNzIHRvIFN0YXJ0XCIsIHN0eWxlKTtcclxuXHJcbiAgICB0aGlzLmlucHV0Lm9uRG93bi5hZGQodGhpcy5vbkRvd24sIHRoaXMpO1xyXG4gIH0sXHJcblxyXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xyXG4gIH0sXHJcblxyXG4gIG9uRG93bjogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KHBsYXllclN0YXRlLmN1cnJlbnRMZXZlbCk7XHJcbiAgfVxyXG59O1xyXG4iLCJ2YXIgUHJlbG9hZGVyID0gZnVuY3Rpb24gKGdhbWUpIHtcclxuICB0aGlzLmFzc2V0ID0gbnVsbDtcclxuICB0aGlzLnJlYWR5ID0gZmFsc2U7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFByZWxvYWRlcjtcclxuXHJcblByZWxvYWRlci5wcm90b3R5cGUgPSB7XHJcblxyXG4gIHByZWxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuYXNzZXQgPSB0aGlzLmFkZC5zcHJpdGUoMzIwLCAyNDAsICdwcmVsb2FkZXInKTtcclxuICAgIHRoaXMuYXNzZXQuYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcclxuXHJcbiAgICB0aGlzLmxvYWQub25Mb2FkQ29tcGxldGUuYWRkT25jZSh0aGlzLm9uTG9hZENvbXBsZXRlLCB0aGlzKTtcclxuICAgIHRoaXMubG9hZC5zZXRQcmVsb2FkU3ByaXRlKHRoaXMuYXNzZXQpO1xyXG4gICAgdGhpcy5sb2FkLmltYWdlKCd0ZXN0c3ByaXRlJywgJ2Fzc2V0cy90ZXN0LnBuZycpO1xyXG4gIH0sXHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5hc3NldC5jcm9wRW5hYmxlZCA9IGZhbHNlO1xyXG4gIH0sXHJcblxyXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgaWYgKCEhdGhpcy5yZWFkeSkge1xyXG4gICAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ01lbnUnKTtcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBvbkxvYWRDb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5yZWFkeSA9IHRydWU7XHJcbiAgfVxyXG59O1xyXG4iLCJ2YXIgU3BsYXNoID0gZnVuY3Rpb24gKGdhbWUpIHtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gU3BsYXNoO1xuXG5TcGxhc2gucHJvdG90eXBlID0ge1xuICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcbiAgfVxufTsiLCJ2YXIgVXRpbHMgPSB7XHJcbiAgICBjb250YWluc09iamVjdDogZnVuY3Rpb24ob2JqLCBsaXN0KSB7XHJcbiAgICAgICAgdmFyIGk7XHJcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGxpc3RbaV0gPT09IG9iaikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0sXHJcblxyXG4gICAgbG9jYWxTdG9yYWdlU3VwcG9ydGVkOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICByZXR1cm4gJ2xvY2FsU3RvcmFnZScgaW4gd2luZG93ICYmIHdpbmRvd1snbG9jYWxTdG9yYWdlJ10gIT09IG51bGw7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBnZW5lcmF0ZVVVSUQ6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIGQgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgIHZhciB1dWlkID0gJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLCBmdW5jdGlvbihjKSB7XHJcbiAgICAgICAgICAgIHZhciByID0gKGQgKyBNYXRoLnJhbmRvbSgpKjE2KSUxNiB8IDA7XHJcbiAgICAgICAgICAgIGQgPSBNYXRoLmZsb29yKGQvMTYpO1xyXG4gICAgICAgICAgICByZXR1cm4gKGM9PSd4JyA/IHIgOiAociYweDd8MHg4KSkudG9TdHJpbmcoMTYpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB1dWlkO1xyXG4gICAgfSxcclxuXHJcbiAgICBnZXRPYmplY3Q6IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcclxuICAgICAgICB2YXIgdmFsdWUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xyXG4gICAgICAgIHJldHVybiB2YWx1ZSAmJiBKU09OLnBhcnNlKHZhbHVlKTtcclxuICAgIH0sXHJcblxyXG4gICAgc2V0T2JqZWN0OiBmdW5jdGlvbihrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeSh2YWx1ZSkpO1xyXG4gICAgfVxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBVdGlsczsiXX0=
